---
layout: page
title: Pack Picker Memory
icon: "fas fa-brain"
order: 2
description: "Match all Sims 4 Expansion and Game Packs before time runs out."
mode: Memory
difficulty: Medium
---

<!--
  Usage:
  - folder MUST end with "/"
  - gp09 is excluded by default via exclude="gp09"
-->
<pack-memory
  ep-count="18"
  gp-count="12"
  pairs="8"
  time-limit="90"
  folder="{{ '/assets/img/packs/mono/' | relative_url }}/"
  exclude="gp09">
</pack-memory>

<style>
  /* Page-level spacing only */
  pack-memory{ display:block; margin: 1.25rem auto; max-width: 920px; }
</style>

<script>
{% raw %}
(() => {
  const tpl = document.createElement("template");
  tpl.innerHTML = `
    <style>
      :host{
        --bg:#ffffff;
        --card:#ffffff;
        --ink:#0b0b0b;
        --muted:#4b5563;
        --border:#d1d5db;
        --shadow:0 14px 20px -10px rgba(0,0,0,.18);
        --radius:22px;
        --gap:10px;
        --flip:0.42s cubic-bezier(.175,.885,.32,1.22);
        --size:146px;
        display:block;
      }

      .shell{
        background: var(--bg);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        padding: 1.1rem 1.1rem 1.2rem;
      }

      .top{
        display:flex;
        justify-content:space-between;
        align-items:flex-start;
        gap: 1rem;
        flex-wrap: wrap;
        margin-bottom: 1rem;
      }

      h2{
        margin:0;
        font-size:1.3rem;
        font-weight:850;
        color:var(--ink);
        letter-spacing:-.01em;
      }
      p{
        margin:.25rem 0 0;
        color:var(--muted);
        font-size:.9rem;
      }

      .stats{
        display:flex;
        gap:.5rem;
        align-items:center;
        flex-wrap:wrap;
        justify-content:flex-end;
      }

      .pill{
        background: var(--card);
        border: 2px solid var(--border);
        border-radius: 999px;
        padding: .42rem .7rem;
        font-weight: 800;
        color: var(--ink);
        font-size: .85rem;
        min-width: 120px;
        text-align:center;
        user-select:none;
      }

      .pill.warn{
        background: #0b0b0b;
        border-color:#0b0b0b;
        color:#ffffff;
      }

      .btn{
        background: #0b0b0b;
        color:#fff;
        border:none;
        border-radius: 12px;
        padding: .5rem .9rem;
        font-weight: 850;
        font-size: .9rem;
        cursor:pointer;
        transition: transform .12s ease, filter .12s ease;
      }
      .btn:hover{ filter: brightness(1.10); transform: translateY(-1px); }
      .btn:active{ transform: translateY(0px); }

      .grid{
        display:grid;
        gap: var(--gap);
        justify-content:center;
        perspective: 1100px;
      }

      @media (min-width: 900px){ .grid{ grid-template-columns: repeat(4, var(--size)); } }
      @media (min-width: 620px) and (max-width: 899px){ .grid{ grid-template-columns: repeat(4, var(--size)); } }
      @media (max-width: 619px){ .grid{ grid-template-columns: repeat(3, var(--size)); } }

      .card{
        width: var(--size);
        height: var(--size);
        position:relative;
        transform-style:preserve-3d;
        transition: transform var(--flip);
        cursor:pointer;
        border-radius: 14px;
        border: 0;
        padding: 0;
        background: transparent;
      }

      /* NEW LOGIC:
         - state="down"  : hidden (question mark)
         - state="up"    : revealed
         - state="match" : revealed + locked
      */
      .card[state="up"],
      .card[state="match"]{
        transform: rotateY(180deg);
      }
      .card[state="match"]{
        pointer-events:none;
        cursor:default;
      }

      .face{
        position:absolute;
        inset:0;
        backface-visibility:hidden;
        border-radius: 14px;
        display:flex;
        align-items:center;
        justify-content:center;
        overflow:hidden;
      }

      .front{
        background: #0b0b0b;
        border: 2px solid rgba(255,255,255,.10);
        color:#ffffff;
        font-weight: 900;
        letter-spacing: .06em;
        font-size: 1.1rem;
        user-select:none;
      }

      .back{
        background: var(--card);
        transform: rotateY(180deg);
        border: 2px solid #0b0b0b;
        padding: 10px;
      }

      .back img{
        width:100%;
        height:100%;
        object-fit:contain;
        display:block;
      }

      .missing{
        display:flex;
        align-items:center;
        justify-content:center;
        width:100%;
        height:100%;
        font-weight:900;
        color:#0b0b0b;
        letter-spacing:.03em;
      }
    </style>

    <div class="shell">
      <div class="top">
        <div class="title">
          <h2>Pack Picker Memory</h2>
          <p>Match all Sims 4 packs before time runs out.</p>
        </div>

        <div class="stats">
          <div class="pill" id="status">Matches: 0 / 0</div>
          <div class="pill" id="misses">Misses: 0</div>
          <div class="pill" id="timer">Time: 00:00</div>
          <button class="btn" id="restart" type="button">Restart</button>
        </div>
      </div>

      <div class="grid" id="grid" aria-label="Memory grid"></div>
    </div>
  `;

  class PackMemory extends HTMLElement{
    constructor(){
      super();
      this.attachShadow({mode:"open"});
      this.shadowRoot.appendChild(tpl.content.cloneNode(true));

      this.$grid = this.shadowRoot.getElementById("grid");
      this.$status = this.shadowRoot.getElementById("status");
      this.$misses = this.shadowRoot.getElementById("misses");
      this.$timer = this.shadowRoot.getElementById("timer");
      this.$restart = this.shadowRoot.getElementById("restart");

      this._deck = [];
      this._open = [];
      this._locked = false;

      this._matches = 0;
      this._misses = 0;

      this._timerId = null;
      this._startMs = 0;

      this._onClick = this._onClick.bind(this);
      this._reset = this._reset.bind(this);
    }

    connectedCallback(){
      this.$grid.addEventListener("click", this._onClick);
      this.$restart.addEventListener("click", this._reset);
      this._reset();
    }

    disconnectedCallback(){
      this.$grid.removeEventListener("click", this._onClick);
      this.$restart.removeEventListener("click", this._reset);
      this._stopTimer();
    }

    get epCount(){ return this._intAttr("ep-count", 18); }
    get gpCount(){ return this._intAttr("gp-count", 12); }
    get pairs(){ return this._intAttr("pairs", 8); }
    get timeLimit(){ return this._intAttr("time-limit", 90); }

    get folder(){
      const raw = (this.getAttribute("folder") || "").trim();
      // hard fallback if Liquid/attr fails
      let f = raw || "/assets/img/packs/mono/";
      if(!f.endsWith("/")) f += "/";
      return f;
    }

    get exclude(){
      // comma-separated: "gp09,gp10"
      return (this.getAttribute("exclude") || "")
        .split(",")
        .map(s => s.trim().toLowerCase())
