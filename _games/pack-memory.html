---
layout: page
title: Pack Picker Memory
icon: "fas fa-brain"
order: 2
description: "Match all Sims 4 Expansion and Game Packs before time runs out."
mode: Memory
difficulty: Medium
---

<div class="pm-wrap"
     id="pack-memory"
     data-ep-count="18"
     data-gp-count="12"
     data-pairs="8"
     data-time-limit="90"
     data-folder="{{ site.baseurl }}/assets/img/packs/mono/"
     data-icon-size="128">
</div>

<style>
  :root{
    --pm-bg: #f8fafc;
    --pm-card: #ffffff;
    --pm-ink: #0f172a;
    --pm-muted: #64748b;
    --pm-border: #e2e8f0;
    --pm-blue: #1e293b;
    --pm-green: #2ecc71;
    --pm-red: #e74c3c;
    --pm-shadow: 0 16px 22px -8px rgba(0,0,0,0.06);
    --pm-radius: 22px;
    --pm-gap: 10px;
    --pm-flip: 0.42s cubic-bezier(0.175, 0.885, 0.32, 1.22);
  }

  .pm-shell{
    max-width: 920px;
    margin: 1.25rem auto;
    background: var(--pm-bg);
    border: 1px solid var(--pm-border);
    border-radius: var(--pm-radius);
    box-shadow: var(--pm-shadow);
    padding: 1.2rem 1.2rem 1.3rem;
  }

  .pm-top{
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap: 1rem;
    flex-wrap: wrap;
    margin-bottom: 1rem;
  }

  .pm-title{
    min-width: 240px;
  }
  .pm-title h2{
    margin:0;
    font-size: 1.3rem;
    font-weight: 850;
    color: var(--pm-ink);
    letter-spacing: -0.01em;
  }
  .pm-title p{
    margin:.25rem 0 0;
    color: var(--pm-muted);
    font-size: .9rem;
  }

  .pm-stats{
    display:flex;
    gap:.5rem;
    align-items:center;
    flex-wrap: wrap;
    justify-content:flex-end;
  }

  .pm-pill{
    background: var(--pm-card);
    border: 2px solid var(--pm-border);
    border-radius: 999px;
    padding: .42rem .7rem;
    font-weight: 800;
    color: var(--pm-blue);
    font-size: .85rem;
    min-width: 108px;
    text-align:center;
  }
  .pm-pill.is-warn{
    background: var(--pm-red);
    border-color: #c0392b;
    color: #fff;
  }

  .pm-btn{
    background: var(--pm-blue);
    color:#fff;
    border:none;
    border-radius: 12px;
    padding: .5rem .9rem;
    font-weight: 850;
    font-size: .9rem;
    cursor:pointer;
    transition: transform .12s ease, filter .12s ease;
  }
  .pm-btn:hover{ filter: brightness(1.06); transform: translateY(-1px); }
  .pm-btn:active{ transform: translateY(0px); }

  .pm-grid{
    display:grid;
    gap: var(--pm-gap);
    justify-content:center;
    perspective: 1100px;
  }

  /* responsive columns */
  @media (min-width: 900px){ .pm-grid{ grid-template-columns: repeat(4, var(--pm-card-size)); } }
  @media (min-width: 620px) and (max-width: 899px){ .pm-grid{ grid-template-columns: repeat(4, var(--pm-card-size)); } }
  @media (max-width: 619px){ .pm-grid{ grid-template-columns: repeat(3, var(--pm-card-size)); } }

  .pm-card{
    width: var(--pm-card-size);
    height: var(--pm-card-size);
    position: relative;
    transform-style: preserve-3d;
    transition: transform var(--pm-flip);
    cursor: pointer;
    border-radius: 14px;
    outline: none;
  }

  .pm-card.is-flipped{ transform: rotateY(180deg); }
  .pm-card.is-matched{ cursor: default; opacity: 0.96; }
  .pm-card:focus-visible{ box-shadow: 0 0 0 3px rgba(46,204,113,.25); }

  .pm-face{
    position:absolute;
    inset:0;
    backface-visibility:hidden;
    border-radius: 14px;
    display:flex;
    align-items:center;
    justify-content:center;
    overflow:hidden;
  }

  .pm-front{
    background: linear-gradient(180deg, #22314a, #152033);
    border: 2px solid rgba(255,255,255,0.08);
    color:#fff;
    font-weight: 900;
    letter-spacing: .06em;
    font-size: 1.1rem;
    user-select: none;
  }

  .pm-back{
    background: var(--pm-card);
    transform: rotateY(180deg);
    border: 2px solid var(--pm-green);
    padding: 10px;
  }

  .pm-back img{
    width: 100%;
    height: 100%;
    object-fit: contain;
    display:block;
  }

  .pm-fallback{
    display:none;
    width: 100%;
    height: 100%;
    border-radius: 10px;
    background: #f1f5f9;
    color: #334155;
    font-weight: 900;
    align-items:center;
    justify-content:center;
    font-size: .95rem;
  }

  .pm-note{
    margin-top: .9rem;
    color: var(--pm-muted);
    font-size: .85rem;
    text-align:center;
  }

  /* overlay */
  .pm-overlay{
    position: fixed;
    inset: 0;
    background: rgba(2,6,23,.55);
    display:none;
    align-items:center;
    justify-content:center;
    padding: 1rem;
    z-index: 9999;
  }
  .pm-modal{
    width: min(520px, 100%);
    background: #fff;
    border-radius: 18px;
    border: 1px solid var(--pm-border);
    box-shadow: 0 28px 44px -18px rgba(0,0,0,.35);
    padding: 1rem 1rem 1.1rem;
    text-align:center;
  }
  .pm-modal h3{
    margin: .1rem 0 .3rem;
    font-size: 1.35rem;
    font-weight: 900;
    color: var(--pm-ink);
  }
  .pm-modal p{
    margin: 0 0 .9rem;
    color: var(--pm-muted);
  }
  .pm-modal .pm-modal-row{
    display:flex;
    gap:.5rem;
    justify-content:center;
    flex-wrap: wrap;
    margin-bottom: .9rem;
  }
  .pm-modal .pm-pill{ min-width: 120px; }
  .pm-modal .pm-btn{ min-width: 140px; }
  .pm-modal.is-win .pm-btn{ background: var(--pm-green); }
</style>

<script>
(function(){
  const host = document.getElementById("pack-memory");
  if(!host) return;

  // config
  const EP = +host.dataset.epCount || 18;
  const GP = +host.dataset.gpCount || 12;
  const PAIRS = +host.dataset.pairs || 8;
  const TIME = +host.dataset.timeLimit || 90;
  const ICON = +host.dataset.iconSize || 128;

  let FOLDER = host.dataset.folder || "";
  if (FOLDER && !FOLDER.endsWith("/")) FOLDER += "/";

  // derive card size: icon + padding
  const CARD = Math.max(ICON + 18, 92);

  host.innerHTML = `
    <div class="pm-shell" style="--pm-card-size:${CARD}px">
      <div class="pm-top">
        <div class="pm-title">
          <h2>Pack Picker Memory</h2>
          <p>Match all Sims 4 packs before time runs out.</p>
        </div>

        <div class="pm-stats">
          <div class="pm-pill" data-pm-status>Matches: 0 / ${PAIRS}</div>
          <div class="pm-pill" data-pm-misses>Misses: 0</div>
          <div class="pm-pill" data-pm-timer>Time: 00:00</div>
          <button class="pm-btn" type="button" data-pm-restart>Restart</button>
        </div>
      </div>

      <div class="pm-grid" data-pm-grid></div>

      <div class="pm-note">Tip: You can play with mouse or keyboard (Tab + Enter).</div>
    </div>

    <div class="pm-overlay" data-pm-overlay>
      <div class="pm-modal" data-pm-modal>
        <h3 data-pm-modal-title>GAME OVER</h3>
        <p data-pm-modal-text>Time is up!</p>
        <div class="pm-modal-row">
          <div class="pm-pill" data-pm-final-matches>Matches: 0 / ${PAIRS}</div>
          <div class="pm-pill" data-pm-final-misses>Misses: 0</div>
        </div>
        <button class="pm-btn" type="button" data-pm-play-again>Play again</button>
      </div>
    </div>
  `;

  const grid = host.querySelector("[data-pm-grid]");
  const statusEl = host.querySelector("[data-pm-status]");
  const missesEl = host.querySelector("[data-pm-misses]");
  const timerEl  = host.querySelector("[data-pm-timer]");
  const restartBtn = host.querySelector("[data-pm-restart]");

  const overlay = host.querySelector("[data-pm-overlay]");
  const modal   = host.querySelector("[data-pm-modal]");
  const modalTitle = host.querySelector("[data-pm-modal-title]");
  const modalText  = host.querySelector("[data-pm-modal-text]");
  const finalMatches = host.querySelector("[data-pm-final-matches]");
  const finalMisses  = host.querySelector("[data-pm-final-misses]");
  const playAgainBtn = host.querySelector("[data-pm-play-again]");

  let opened = [];
  let locked = false;
  let matches = 0;
  let misses = 0;
  let timerId = null;
  let startMs = 0;

  const packs = [];
  for (let i=1;i<=EP;i++) packs.push(`ep${String(i).padStart(2,"0")}`);
  for (let i=1;i<=GP;i++) packs.push(`gp${String(i).padStart(2,"0")}`);

  function shuffle(a){ return a.sort(()=>Math.random()-0.5); }

  function format(s){
    const m = Math.floor(s/60);
    const sec = s%60;
    return String(m).padStart(2,"0")+":"+String(sec).padStart(2,"0");
  }

  function showOverlay(isWin){
    finalMatches.textContent = `Matches: ${matches} / ${PAIRS}`;
    finalMisses.textContent = `Misses: ${misses}`;

    modal.classList.toggle("is-win", !!isWin);

    if(isWin){
      modalTitle.textContent = "VICTORY";
      modalText.textContent = `Perfect memory! You had ${misses} misses.`;
      playAgainBtn.textContent = "Play again";
    } else {
      modalTitle.textContent = "GAME OVER";
      modalText.textContent = "Time is up!";
      playAgainBtn.textContent = "Try again";
    }

    overlay.style.display = "flex";
  }

  function hideOverlay(){
    overlay.style.display = "none";
  }

  function setTimer(left){
    timerEl.textContent = "Time: " + format(Math.max(left,0));
    timerEl.classList.toggle("is-warn", left <= 10 && left > 0);
  }

  function flipBack(){
    opened.forEach(c => c.classList.remove("is-flipped"));
    opened = [];
  }

  function onCardClick(card){
    if(locked) return;
    if(card.classList.contains("is-matched")) return;
    if(card.classList.contains("is-flipped")) return;

    card.classList.add("is-flipped");
    opened.push(card);

    if(opened.length < 2) return;

    locked = true;
    const a = opened[0].dataset.id;
    const b = opened[1].dataset.id;

    if(a === b){
      matches++;
      opened[0].classList.add("is-matched");
      opened[1].classList.add("is-matched");
      opened = [];
      locked = false;

      statusEl.textContent = `Matches: ${matches} / ${PAIRS}`;

      if(matches === PAIRS){
        clearInterval(timerId);
        setTimeout(()=>showOverlay(true), 350);
      }
    } else {
      misses++;
      missesEl.textContent = `Misses: ${misses}`;
      setTimeout(()=>{
        flipBack();
        locked = false;
      }, 820);
    }
  }

  function buildDeck(){
    const chosen = shuffle([...packs]).slice(0, PAIRS);
    return shuffle([...chosen, ...chosen]);
  }

  function reset(){
    hideOverlay();

    grid.innerHTML = "";
    opened = [];
    locked = false;
    matches = 0;
    misses = 0;

    statusEl.textContent = `Matches: 0 / ${PAIRS}`;
    missesEl.textContent = "Misses: 0";
    timerEl.classList.remove("is-warn");

    clearInterval(timerId);
    startMs = Date.now();
    setTimer(TIME);

    timerId = setInterval(()=>{
      const left = TIME - Math.floor((Date.now() - startMs)/1000);
      setTimer(left);

      if(left <= 0){
        clearInterval(timerId);
        locked = true;
        // falls zwei offen sind, damit nix "halb" stehen bleibt
        flipBack();
        showOverlay(false);
      }
    }, 250);

    const deck = buildDeck();

    deck.forEach(id=>{
      const card = document.createElement("button");
      card.type = "button";
      card.className = "pm-card";
      card.dataset.id = id;
      card.setAttribute("aria-label", "Card");

      const imgSrc = `${FOLDER}${id}.png`;

      card.innerHTML = `
        <div class="pm-face pm-front">?</div>
        <div class="pm-face pm-back">
          <img src="${imgSrc}" alt="" loading="lazy">
          <div class="pm-fallback">${id.toUpperCase()}</div>
        </div>
      `;

      const img = card.querySelector("img");
      const fb  = card.querySelector(".pm-fallback");
      img.addEventListener("error", ()=>{
        img.style.display = "none";
        fb.style.display = "flex";
      });

      card.addEventListener("click", ()=>onCardClick(card));
      grid.appendChild(card);
    });
  }

  restartBtn.addEventListener("click", reset);
  playAgainBtn.addEventListener("click", reset);
  overlay.addEventListener("click", (e)=>{
    if(e.target === overlay) hideOverlay();
  });

  reset();
})();
</script>
