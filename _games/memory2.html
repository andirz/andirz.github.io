---
layout: page
title: Pack Picker Memory
icon: "fas fa-brain"
order: 2
description: "Match all Sims 4 Expansion and Game Packs before time runs out."
mode: Memory
difficulty: Medium
---

<pack-memory
  ep-count="18"
  gp-count="12"
  pairs="8"
  time-limit="90"
  folder="{{ '/assets/img/packs/mono/' | relative_url }}/"
  exclude="gp09">
</pack-memory>

<style>
  pack-memory{ display:block; margin: 1.25rem auto; max-width: 920px; }
</style>

{% raw %}
<script>
/*
=========================================================
PACK MEMORY – IMPORTANT PACK RULES (DO NOT REMOVE)
---------------------------------------------------------
• EP: ep01 – ep18  (normal)
• GP: gp01 – gp12 BUT gp09 MUST ALWAYS BE EXCLUDED
        (no icon exists for gp09)
• SP: NOT continuous!
      Valid Stuff Packs are:
      sp01–sp18 PLUS sp46 and sp49

If this logic is changed, icons WILL break.
=========================================================
*/

(() => {
  if (customElements.get("pack-memory")) return;

  const tpl = document.createElement("template");
  tpl.innerHTML = `
    <style>
      :host{
        --bg:#ffffff;
        --card:#ffffff;
        --ink:#0b0b0b;
        --muted:#4b5563;
        --border:#d1d5db;
        --shadow:0 14px 20px -10px rgba(0,0,0,.18);
        --radius:22px;
        --gap:10px;
        --flip:0.42s cubic-bezier(.175,.885,.32,1.22);
        --size:146px;
        display:block;
      }

      .shell{
        background: var(--bg);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        padding: 1.1rem;
        position: relative;
      }

      .top{
        display:flex;
        justify-content:space-between;
        align-items:flex-start;
        gap: 1rem;
        flex-wrap: wrap;
        margin-bottom: 1rem;
      }

      h2{ margin:0; font-size:1.3rem; font-weight:850; }
      p{ margin:.25rem 0 0; color:var(--muted); font-size:.9rem; }

      .stats{
        display:flex;
        gap:.5rem;
        align-items:center;
        flex-wrap:wrap;
        justify-content:flex-end;
      }

      .pill{
        border:2px solid var(--border);
        border-radius:999px;
        padding:.42rem .7rem;
        font-weight:800;
        font-size:.85rem;
        min-width:120px;
        text-align:center;
      }

      .pill.warn{ background:#0b0b0b; color:#fff; }

      .btn{
        background:#0b0b0b;
        color:#fff;
        border:none;
        border-radius:12px;
        padding:.5rem .9rem;
        font-weight:850;
        cursor:pointer;
      }

      .toggle{
        display:inline-flex;
        align-items:center;
        gap:.45rem;
        font-weight:850;
        font-size:.85rem;
        padding:.38rem .65rem;
        border-radius:999px;
        border:2px solid var(--border);
        cursor:pointer;
      }

      .grid{
        display:grid;
        gap:var(--gap);
        justify-content:center;
      }

      @media (min-width:900px){ .grid{ grid-template-columns:repeat(4,var(--size)); } }
      @media (max-width:899px){ .grid{ grid-template-columns:repeat(3,var(--size)); } }

      .card{
        width:var(--size);
        height:var(--size);
        transform-style:preserve-3d;
        transition:transform var(--flip);
        cursor:pointer;
        border-radius:14px;
        background:none;
        border:0;
        padding:0;
      }

      .card[state="up"],
      .card[state="match"]{ transform:rotateY(180deg); }
      .card[state="match"]{ pointer-events:none; }

      .face{
        position:absolute;
        inset:0;
        backface-visibility:hidden;
        border-radius:14px;
        display:flex;
        align-items:center;
        justify-content:center;
      }

      .front{
        background:#0b0b0b;
        color:#fff;
        font-weight:900;
        font-size:1.1rem;
      }

      .back{
        background:#fff;
        transform:rotateY(180deg);
        border:2px solid #0b0b0b;
        padding:10px;
      }

      .back img{
        width:100%;
        height:100%;
        object-fit:contain;
      }
    </style>

    <div class="shell">
      <div class="top">
        <div>
          <h2>Pack Picker Memory</h2>
          <p>EP + GP always active. Optional SP.</p>
        </div>

        <div class="stats">
          <div class="pill" id="status">Matches: 0 / 0</div>
          <div class="pill" id="misses">Misses: 0</div>
          <div class="pill" id="timer">Time: 00:00</div>

          <label class="toggle">
            <input id="sound" type="checkbox" checked /> Sound
          </label>

          <label class="toggle">
            <input id="addSP" type="checkbox" checked /> SP
          </label>

          <button class="btn" id="restart">Restart</button>
        </div>
      </div>

      <div class="grid" id="grid"></div>
    </div>
  `;

  class PackMemory extends HTMLElement{
    constructor(){
      super();
      this.attachShadow({mode:"open"});
      this.shadowRoot.appendChild(tpl.content.cloneNode(true));

      this.$grid = this.shadowRoot.getElementById("grid");
      this.$status = this.shadowRoot.getElementById("status");
      this.$misses = this.shadowRoot.getElementById("misses");
      this.$timer = this.shadowRoot.getElementById("timer");
      this.$sound = this.shadowRoot.getElementById("sound");
      this.$addSP = this.shadowRoot.getElementById("addSP");
      this.$restart = this.shadowRoot.getElementById("restart");

      this._open = [];
      this._matches = 0;
      this._misses = 0;

      this.$restart.onclick = () => this._reset();
      this.$addSP.onchange = () => this._reset();

      this._reset();
    }

    _buildPool(){
      const pool = [];
      const exclude = new Set(["gp09"]); // HARD RULE

      for(let i=1;i<=18;i++) pool.push(`ep${String(i).padStart(2,"0")}`);
      for(let i=1;i<=12;i++){
        const id = `gp${String(i).padStart(2,"0")}`;
        if(!exclude.has(id)) pool.push(id);
      }

      if(this.$addSP.checked){
        for(let i=1;i<=18;i++) pool.push(`sp${String(i).padStart(2,"0")}`);
        pool.push("sp46","sp49");
      }

      return pool;
    }

    _reset(){
      this.$grid.innerHTML = "";
      this._open = [];
      this._matches = 0;
      this._misses = 0;

      const pool = this._shuffle(this._buildPool()).slice(0,8);
      this._deck = this._shuffle(pool.concat(pool));

      for(const id of this._deck){
        const c = document.createElement("button");
        c.className = "card";
        c.dataset.id = id;
        c.setAttribute("state","down");

        c.innerHTML = `
          <div class="face front">?</div>
          <div class="face back"><img src="${this.getAttribute("folder")}${id}.png"></div>
        `;
        c.onclick = () => this._flip(c);
        this.$grid.appendChild(c);
      }

      this.$status.textContent = "Matches: 0 / 8";
      this.$misses.textContent = "Misses: 0";
    }

    _flip(card){
      if(card.getAttribute("state")!=="down") return;
      card.setAttribute("state","up");
      this._open.push(card);

      if(this._open.length===2){
        const [a,b] = this._open;
        if(a.dataset.id===b.dataset.id){
          a.setAttribute("state","match");
          b.setAttribute("state","match");
          this._matches++;
          this.$status.textContent = `Matches: ${this._matches} / 8`;
          this._open=[];
        }else{
          this._misses++;
          this.$misses.textContent = `Misses: ${this._misses}`;
          setTimeout(()=>{
            a.setAttribute("state","down");
            b.setAttribute("state","down");
            this._open=[];
          },700);
        }
      }
    }

    _shuffle(a){
      for(let i=a.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [a[i],a[j]]=[a[j],a[i]];
      }
      return a;
    }
  }

  customElements.define("pack-memory", PackMemory);
})();
</script>
{% endraw %}
