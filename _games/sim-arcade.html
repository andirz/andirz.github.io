---
layout: page
title: Sim-Arcade
icon: "fas fa-gamepad"
---

<div class="arcade-shell">
  <div class="arc-nav">
    <button class="arc-tab active" data-game="memory">
      <i class="fas fa-brain"></i> Pack Memory
    </button>
    <button class="arc-tab" data-game="shooting">
      <i class="fas fa-crosshairs"></i> Quickdraw
    </button>
  </div>

  <hr class="arc-divider">

  <!-- MEMORY -->
  <div id="memory" class="arc-game-container active">
    <div class="pm-shell" id="pm-root"
         data-folder="{{ '/assets/img/packs/mono/' | relative_url }}">
      <div class="pm-stats">
        <div class="pm-pill" id="pm-status">Matches: 0 / 8</div>
        <div class="pm-pill" id="pm-timer">Time: 90</div>
        <button class="pm-btn" id="pm-restart">Restart</button>
      </div>
      <div class="pm-grid" id="pm-grid"></div>
    </div>
  </div>

  <!-- SHOOTING -->
  <div id="shooting" class="arc-game-container">
    <section class="shoot-section">
      <div class="shoot-stats">
        <div class="shoot-badge">Score: <span id="s-score">0</span></div>
        <div class="shoot-badge">Time: <span id="s-time">30</span>s</div>
        <button class="pm-btn" id="qd-start" style="background:#e74c3c">Start</button>
      </div>
      <div class="shoot-stage" id="s-stage"></div>
    </section>
  </div>
</div>

<style>
.arcade-shell{max-width:940px;margin:0 auto}
.arc-nav{display:flex;gap:15px;margin-bottom:10px}
.arc-tab{background:none;border:none;padding:12px 20px;font-size:1.1rem;font-weight:800;color:#64748b;cursor:pointer;border-bottom:3px solid transparent}
.arc-tab.active{color:#1e293b;border-bottom-color:#3b82f6}
.arc-divider{border:0;border-top:1px solid #e2e8f0;margin-bottom:30px}
.arc-game-container{display:none}
.arc-game-container.active{display:block}

.pm-shell{background:#f8fafc;border:1px solid #e2e8f0;border-radius:22px;padding:20px;text-align:center}
.pm-stats{display:flex;gap:10px;justify-content:center;margin-bottom:20px;flex-wrap:wrap}
.pm-pill{background:white;border:2px solid #e2e8f0;border-radius:999px;padding:8px 15px;font-weight:800}
.pm-grid{display:grid;gap:10px;grid-template-columns:repeat(4,1fr);max-width:600px;margin:0 auto}
.pm-card{aspect-ratio:1/1;position:relative;transform-style:preserve-3d;transition:.4s;cursor:pointer;background:none;border:none}
.pm-card.is-flipped{transform:rotateY(180deg)}
.pm-face{position:absolute;inset:0;backface-visibility:hidden;border-radius:12px;display:flex;align-items:center;justify-content:center}
.pm-front{background:#1e293b;color:white;font-size:1.5rem;font-weight:900}
.pm-back{background:white;transform:rotateY(180deg);border:2px solid #2ecc71;padding:5px}
.pm-back img{width:100%;height:100%;object-fit:contain}
.pm-btn{background:#1e293b;color:white;border:none;border-radius:10px;padding:8px 16px;font-weight:800;cursor:pointer}

.shoot-section{background:#f8fafc;border-radius:22px;padding:20px;border:1px solid #e2e8f0;text-align:center}
.shoot-stats{display:flex;gap:10px;justify-content:center;margin-bottom:15px}
.shoot-badge{background:white;border:2px solid #e2e8f0;border-radius:999px;padding:8px 15px;font-weight:800}
.shoot-stage{position:relative;width:100%;max-width:500px;aspect-ratio:1/1;background:#0f172a;border-radius:18px;margin:0 auto;overflow:hidden}
.target-img{position:absolute;width:70px;cursor:pointer}
.evil{filter:brightness(.4) sepia(1) hue-rotate(-50deg)}
.good{filter:brightness(1.2) drop-shadow(0 0 10px #2ecc71)}
</style>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const tabs = Array.from(document.querySelectorAll('.arc-tab'))
  const containers = Array.from(document.querySelectorAll('.arc-game-container'))
  const imgPath = "{{ '/assets/img/packs/mono/' | relative_url }}"

  const activateTab = (targetId) => {
    containers.forEach((c) => c.classList.remove('active'))
    tabs.forEach((t) => t.classList.remove('active'))
    const activeContainer = document.getElementById(targetId)
    const activeTab = tabs.find((tab) => tab.dataset.game === targetId)
    if (activeContainer) activeContainer.classList.add('active')
    if (activeTab) activeTab.classList.add('active')
  }

  tabs.forEach((tab) => {
    tab.addEventListener('click', () => {
      activateTab(tab.dataset.game)
    })
  })

  /* SHOOTING */
  let sScore = 0
  let sTime = 30
  let sRun = false
  let sClock
  let sLoop
  const sStage = document.getElementById('s-stage')
  const sScoreEl = document.getElementById('s-score')
  const sTimeEl = document.getElementById('s-time')
  const sStart = document.getElementById('qd-start')

  const clearShootingTimers = () => {
    clearInterval(sClock)
    clearInterval(sLoop)
  }

  const updateScore = (delta) => {
    sScore += delta
    if (sScoreEl) sScoreEl.textContent = sScore
  }

  const spawn = () => {
    if (!sRun || !sStage) return
    const stageWidth = sStage.offsetWidth
    const stageHeight = sStage.offsetHeight
    if (!stageWidth || !stageHeight) return

    const evil = Math.random() > 0.4
    const img = document.createElement('img')
    img.src = imgPath + (Math.random() > 0.5 ? 'ep01.png' : 'gp01.png')
    img.className = `target-img ${evil ? 'evil' : 'good'}`
    img.style.left = Math.random() * (stageWidth - 70) + 'px'
    img.style.top = Math.random() * (stageHeight - 70) + 'px'
    img.addEventListener('click', () => {
      updateScore(evil ? 10 : -50)
      img.remove()
    })
    sStage.appendChild(img)
    setTimeout(() => img.remove(), 1000)
  }

  const qdStart = () => {
    if (!sStage || !sScoreEl || !sTimeEl) return
    clearShootingTimers()
    sStage.innerHTML = ''
    sScore = 0
    sTime = 30
    sRun = true
    sScoreEl.textContent = 0
    sTimeEl.textContent = 30

    sLoop = setInterval(spawn, 900)
    sClock = setInterval(() => {
      sTime -= 1
      sTimeEl.textContent = sTime
      if (sTime <= 0) {
        clearShootingTimers()
        sRun = false
      }
    }, 1000)
  }

  if (sStart) sStart.addEventListener('click', qdStart)

  /* MEMORY */
  const grid = document.getElementById('pm-grid')
  const folder = "{{ '/assets/img/packs/mono/' | relative_url }}"
  const statusEl = document.getElementById('pm-status')
  const timerEl = document.getElementById('pm-timer')
  const restartBtn = document.getElementById('pm-restart')
  let opened = []
  let lock = false
  let match = 0
  let time = 90
  let timer

  const updateTimer = () => {
    if (timerEl) timerEl.textContent = `Time: ${time}`
  }

  const updateStatus = () => {
    if (statusEl) statusEl.textContent = `Matches: ${match} / 8`
  }

  const stopTimer = () => {
    clearInterval(timer)
  }

  const startTimer = () => {
    stopTimer()
    timer = setInterval(() => {
      time -= 1
      updateTimer()
      if (time <= 0) {
        stopTimer()
        lock = true
      }
    }, 1000)
  }

  const buildDeck = () => {
    const deck = []
    for (let i = 1; i <= 8; i += 1) {
      const id = `ep${String(i).padStart(2, '0')}`
      deck.push(id, id)
    }
    return deck.sort(() => Math.random() - 0.5)
  }

  const flip = (card) => {
    if (lock || card.classList.contains('is-flipped')) return
    card.classList.add('is-flipped')
    opened.push(card)
    if (opened.length !== 2) return

    lock = true
    const [first, second] = opened
    if (first.dataset.id === second.dataset.id) {
      match += 1
      updateStatus()
      opened = []
      lock = false
      if (match === 8) stopTimer()
      return
    }

    setTimeout(() => {
      opened.forEach((x) => x.classList.remove('is-flipped'))
      opened = []
      lock = false
    }, 800)
  }

  const reset = () => {
    if (!grid) return
    grid.innerHTML = ''
    opened = []
    lock = false
    match = 0
    time = 90
    updateStatus()
    updateTimer()
    startTimer()

    buildDeck().forEach((id) => {
      const card = document.createElement('button')
      card.className = 'pm-card'
      card.dataset.id = id
      card.innerHTML = `<div class="pm-face pm-front">?</div>
                 <div class="pm-face pm-back"><img src="${folder}${id}.png" alt=""></div>`
      card.addEventListener('click', () => flip(card))
      grid.appendChild(card)
    })
  }

  if (restartBtn) restartBtn.addEventListener('click', reset)

  activateTab('memory')
  reset()
})
</script>
