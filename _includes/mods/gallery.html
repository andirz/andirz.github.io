{% comment %}
  NO-JS Mod Gallery (Radio Switch)
  - ONLY img01.png..img04.png in /assets/img/mods/<mod_id>/
  - Show gallery ONLY if img01.png exists
  - Click thumbs => switches big image (no new tab, no browser open)
  - Big image not clickable
  - Kill glow completely
{% endcomment %}

{% assign g_filename = page.path | split: "/" | last | replace: ".md", "" %}
{% assign g_mod_id = page.mod_id | default: g_filename %}
{% assign g_dir = "/assets/img/mods/" | append: g_mod_id | append: "/" %}

{% assign p1 = g_dir | append: "img01.png" %}
{% assign p2 = g_dir | append: "img02.png" %}
{% assign p3 = g_dir | append: "img03.png" %}
{% assign p4 = g_dir | append: "img04.png" %}

{% assign e1 = false %}
{% assign e2 = false %}
{% assign e3 = false %}
{% assign e4 = false %}

{% for f in site.static_files %}{% if f.path == p1 %}{% assign e1 = true %}{% break %}{% endif %}{% endfor %}
{% for f in site.static_files %}{% if f.path == p2 %}{% assign e2 = true %}{% break %}{% endif %}{% endfor %}
{% for f in site.static_files %}{% if f.path == p3 %}{% assign e3 = true %}{% break %}{% endif %}{% endfor %}
{% for f in site.static_files %}{% if f.path == p4 %}{% assign e4 = true %}{% break %}{% endif %}{% endfor %}

{% if e1 %}

<h3 class="mod-gallery-title">Gallery</h3>

<div class="mod-split-gallery-radios" data-gallery="{{ g_mod_id }}">

  {%- comment -%} Radios (hidden) {%- endcomment -%}
  <input class="g-radio" type="radio" name="gal-{{ g_mod_id }}" id="gal-{{ g_mod_id }}-1" checked>
  {% if e2 %}<input class="g-radio" type="radio" name="gal-{{ g_mod_id }}" id="gal-{{ g_mod_id }}-2">{% endif %}
  {% if e3 %}<input class="g-radio" type="radio" name="gal-{{ g_mod_id }}" id="gal-{{ g_mod_id }}-3">{% endif %}
  {% if e4 %}<input class="g-radio" type="radio" name="gal-{{ g_mod_id }}" id="gal-{{ g_mod_id }}-4">{% endif %}

  <!-- MAIN -->
  <div class="g-main">
    <div class="g-panel g-panel-1">
      <img src="{{ p1 }}" alt="{{ page.title }} – gallery image 1">
    </div>

    {% if e2 %}
    <div class="g-panel g-panel-2">
      <img src="{{ p2 }}" alt="{{ page.title }} – gallery image 2">
    </div>
    {% endif %}

    {% if e3 %}
    <div class="g-panel g-panel-3">
      <img src="{{ p3 }}" alt="{{ page.title }} – gallery image 3">
    </div>
    {% endif %}

    {% if e4 %}
    <div class="g-panel g-panel-4">
      <img src="{{ p4 }}" alt="{{ page.title }} – gallery image 4">
    </div>
    {% endif %}
  </div>

  <!-- THUMBS -->
  <div class="g-thumbs" aria-label="Gallery thumbnails">
    <label class="g-thumb" for="gal-{{ g_mod_id }}-1" aria-label="Show gallery image 1">
      <img src="{{ p1 }}" alt="{{ page.title }} – gallery thumbnail 1">
    </label>

    {% if e2 %}
    <label class="g-thumb" for="gal-{{ g_mod_id }}-2" aria-label="Show gallery image 2">
      <img src="{{ p2 }}" alt="{{ page.title }} – gallery thumbnail 2">
    </label>
    {% endif %}

    {% if e3 %}
    <label class="g-thumb" for="gal-{{ g_mod_id }}-3" aria-label="Show gallery image 3">
      <img src="{{ p3 }}" alt="{{ page.title }} – gallery thumbnail 3">
    </label>
    {% endif %}

    {% if e4 %}
    <label class="g-thumb" for="gal-{{ g_mod_id }}-4" aria-label="Show gallery image 4">
      <img src="{{ p4 }}" alt="{{ page.title }} – gallery thumbnail 4">
    </label>
    {% endif %}
  </div>

</div>

<style>
/* Title */
.mod-gallery-title{
  margin:22px 0 10px;
  font-size:1.25rem;
  font-weight:700;
  border-bottom:1px solid var(--border-color);
  padding-bottom:4px;
}

/* Layout: big takes full space */
.mod-split-gallery-radios{
  width:100%;
  display:grid;
  grid-template-columns: 1fr 150px;
  gap:16px;
  margin:14px 0 28px;
}

/* Hide radios completely */
.g-radio{
  position:absolute;
  left:-9999px;
}

/* Main area */
.g-main{
  background:#000;
  border-radius:14px;
  overflow:hidden;
  border:1px solid var(--border-color);
  position:relative;
  width:100%;
  aspect-ratio:16/9;
}

.g-panel{
  position:absolute;
  inset:0;
  display:none;
}

.g-panel img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}

/* Default + switching */
#gal-{{ g_mod_id }}-1:checked ~ .g-main .g-panel-1{ display:block; }
{% if e2 %}#gal-{{ g_mod_id }}-2:checked ~ .g-main .g-panel-2{ display:block; }{% endif %}
{% if e3 %}#gal-{{ g_mod_id }}-3:checked ~ .g-main .g-panel-3{ display:block; }{% endif %}
{% if e4 %}#gal-{{ g_mod_id }}-4:checked ~ .g-main .g-panel-4{ display:block; }{% endif %}

/* Thumbs */
.g-thumbs{
  display:flex;
  flex-direction:column;
  gap:10px;
}

/* Thumb as label (no link, no href issues) */
.g-thumb{
  display:block;
  border-radius:10px;
  overflow:hidden;
  border:2px solid rgba(0,0,0,0.25);
  background:#000;
  cursor:pointer;

  /* KILL GLOW HARD (theme-proof) */
  box-shadow:none !important;
  filter:none !important;
  outline:none !important;
  text-decoration:none !important;
}

.g-thumb:hover,
.g-thumb:focus,
.g-thumb:focus-visible,
.g-thumb:active{
  box-shadow:none !important;
  filter:none !important;
  outline:none !important;
}

/* Active thumb border (based on checked radio) */
#gal-{{ g_mod_id }}-1:checked ~ .g-thumbs label[for="gal-{{ g_mod_id }}-1"]{ border-color: rgba(0,0,0,0.75); }
{% if e2 %}#gal-{{ g_mod_id }}-2:checked ~ .g-thumbs label[for="gal-{{ g_mod_id }}-2"]{ border-color: rgba(0,0,0,0.75); }{% endif %}
{% if e3 %}#gal-{{ g_mod_id }}-3:checked ~ .g-thumbs label[for="gal-{{ g_mod_id }}-3"]{ border-color: rgba(0,0,0,0.75); }{% endif %}
{% if e4 %}#gal-{{ g_mod_id }}-4:checked ~ .g-thumbs label[for="gal-{{ g_mod_id }}-4"]{ border-color: rgba(0,0,0,0.75); }{% endif %}

.g-thumb img{
  width:100%;
  aspect-ratio:16/9;
  object-fit:cover;
  display:block;
}

/* Mobile */
@media (max-width: 900px){
  .mod-split-gallery-radios{
    grid-template-columns:1fr;
  }
  .g-thumbs{
    flex-direction:row;
    overflow:auto;
    padding-bottom:6px;
  }
  .g-thumb{
    min-width:120px;
  }
}
</style>

{% endif %}
