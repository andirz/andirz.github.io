{%- comment -%}
related-mods.html
Icon-only related mods (2 Ã— 3)
Same logic as categories
{%- endcomment -%}

{%- assign max_items = 6 -%}
{%- assign count = 0 -%}
{%- assign current_id = page.mod_id -%}

{%- assign current_categories = page.categories -%}
{%- if current_categories == nil -%}
  {%- assign current_data = site.data.mods | where: "id", current_id | first -%}
  {%- assign current_categories = current_data.categories -%}
{%- endif -%}

{%- if current_categories == nil -%}
  {%- assign current_categories = "" | split: "|" -%}
{%- endif -%}

<section class="related-mods-icons">

  <strong class="related-title">Related Mods:</strong>

  <div class="related-mods-grid">
    {%- for mod in site.data.mods -%}
      {%- if count < max_items and mod.id != current_id -%}

        {%- assign mod_page = site.mods | where: "mod_id", mod.id | first -%}
        {%- assign mod_categories = mod_page.categories | default: mod.categories -%}

        {%- assign match = false -%}
        {%- for cat in mod_categories -%}
          {%- if current_categories contains cat -%}
            {%- assign match = true -%}
          {%- endif -%}
        {%- endfor -%}

        {%- if match and mod_page -%}
          <a
            href="{{ mod_page.url | relative_url }}"
            class="related-mod-icon"
            title="{{ mod.name }}"
            aria-label="{{ mod.name }}"
          >
            <i class="fas fa-puzzle-piece"></i>
          </a>
          {%- assign count = count | plus: 1 -%}
        {%- endif -%}

      {%- endif -%}
    {%- endfor -%}
  </div>

</section>

<style>
.related-mods-icons {
  margin-top: 1.2rem;
}

.related-title {
  display: block;
  margin-bottom: 8px;
  font-weight: 800;
}

.related-mods-grid {
  display: grid;
  grid-template-columns: repeat(3, 42px);
  gap: 10px 12px;
}

.related-mod-icon {
  width: 42px;
  height: 30px;
  border-radius: 999px;
  display: flex;
  align-items: center;
  justify-content: center;
  text-decoration: none;

  background: rgba(0,0,0,0.04);
  color: rgba(0,0,0,0.45);

  transition: background 120ms ease, transform 120ms ease;
}

.related-mod-icon i {
  font-size: 0.9rem;
}

.related-mod-icon:hover {
  background: rgba(0,0,0,0.08);
  transform: translateY(-1px);
}

@media (max-width: 600px) {
  .related-mods-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}
</style>
