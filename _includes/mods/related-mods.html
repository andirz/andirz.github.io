{%- comment -%}
related-mods.html
- icon pills (2 rows × 3)
- category-based matching (like categories)
- "force clickable" styles against overlays/global CSS
{%- endcomment -%}

{%- assign max_items = 6 -%}
{%- assign count = 0 -%}
{%- assign current_id = page.mod_id -%}

{%- assign current_categories = page.categories -%}
{%- if current_categories == nil -%}
  {%- assign current_data = site.data.mods | where: "id", current_id | first -%}
  {%- assign current_categories = current_data.categories -%}
{%- endif -%}
{%- if current_categories == nil -%}
  {%- assign current_categories = "" | split: "|" -%}
{%- endif -%}

<section class="related-mods-icons" aria-label="Related mods">
  <div class="related-mods-head">
    <strong class="related-title">Related Mods:</strong>
  </div>

  <div class="related-mods-grid">
    {%- for mod in site.data.mods -%}
      {%- if count < max_items and mod.id != current_id -%}

        {%- assign mod_page = site.mods | where: "mod_id", mod.id | first -%}
        {%- if mod_page -%}
          {%- assign mod_categories = mod_page.categories | default: mod.categories -%}

          {%- assign match = false -%}
          {%- for cat in mod_categories -%}
            {%- if current_categories contains cat -%}
              {%- assign match = true -%}
            {%- endif -%}
          {%- endfor -%}

          {%- if match -%}
            <a
              class="related-mod-pill"
              href="{{ mod_page.url | relative_url }}"
              title="{{ mod.name }}"
              aria-label="{{ mod.name }}"
            >
              <i class="fas fa-puzzle-piece" aria-hidden="true"></i>
            </a>
            {%- assign count = count | plus: 1 -%}
          {%- endif -%}
        {%- endif -%}

      {%- endif -%}
    {%- endfor -%}
  </div>
</section>

<style>
/* Container darf NICHT Klicks schlucken */
.related-mods-icons{
  position: relative;
  z-index: 2;
}

/* Head wie im Mockup */
.related-mods-head{
  margin-bottom: 10px;
}

.related-title{
  font-weight: 900;
  font-size: 1.1rem;
}

/* 2×3 Pills */
.related-mods-grid{
  display: grid;
  grid-template-columns: repeat(3, 56px);
  gap: 14px 16px;
}

/* Pill-Button: "force clickable" */
.related-mod-pill{
  position: relative;
  z-index: 5;
  pointer-events: auto !important;

  width: 56px;
  height: 36px;
  border-radius: 999px;

  display: flex;
  align-items: center;
  justify-content: center;

  text-decoration: none !important;
  background: rgba(0,0,0,0.035);
  color: rgba(0,0,0,0.45);

  transition: transform 120ms ease, background 120ms ease;
}

.related-mod-pill:hover{
  background: rgba(0,0,0,0.07);
  transform: translateY(-1px);
}

.related-mod-pill i{
  font-size: 0.95rem;
  opacity: 0.85;
}

/* Mobile: bleibt 3 pro Reihe, aber flexibel */
@media (max-width: 520px){
  .related-mods-grid{
    grid-template-columns: repeat(3, minmax(52px, 1fr));
  }
  .related-mod-pill{
    width: 100%;
  }
}
</style>
